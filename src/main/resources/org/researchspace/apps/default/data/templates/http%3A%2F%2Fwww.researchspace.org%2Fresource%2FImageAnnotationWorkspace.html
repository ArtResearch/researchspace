<mp-event-proxy id='refresh-image-list' on-event-source='image-editor' on-event-type='IIIFViewer.Updated'
                proxy-event-type='Component.TemplateUpdate' proxy-targets='["image-with-regions"]'
></mp-event-proxy>

<mp-event-proxy id='reset-form-on-image-update' on-event-source='image-editor' on-event-type='IIIFViewer.Updated'
                proxy-event-type='Component.TemplateUpdate' proxy-targets='["region-form"]'
></mp-event-proxy>

<mp-event-proxy id='add-new-manifest' on-event-source='set-action__km-add-frame' on-event-type='Dashboard.AddFrame'
                proxy-event-type='IIIFViewer.AddImagesForObject' proxy-targets='["image-editor"]'
></mp-event-proxy>

<div class="frame-imageAnnotationWorkspace__container">
      <div class="frame-imageAnnotationWorkspace__viewer">
        {{> @partial-block }}
      </div>

      <div class="frame-imageAnnotationWorkspace__formArea_bg"></div>

      <div class="frame-imageAnnotationWorkspace__formArea">

        <div class="frame-imageAnnotationWorkspace__formArea_content">

          <mp-event-target-template-render id='image-with-regions' template='{{> template}}'>
            <template id='template'>
                <div class="frame-imageAnnotationWorkspace__annotations">
                  {{#if images}}

                  <div>
                    {{#each images}}
                      <h1><i class="rs-icon rs-icon-image"></i><span>Image: &nbsp;<strong><semantic-link iri='{{imageIri}}'></semantic-link></strong></span></h1>

                      <h2 style="margin-left: 15px;">Represents: &nbsp;<strong><semantic-link iri='{{objectIri}}'></semantic-link></strong></h2>
                        
                      {{#if regions}}
                      <div class="frame-imageAnnotationWorkspace__regionsArea">
                        <h2><i class="rs-icon rs-icon-area_annotation"></i><span>Image Regions</span></h2>
                        <div class="frame-imageAnnotationWorkspace__regions_container">
                          {{#each regions}}
                          <div class="frame-imageAnnotationWorkspace__region">
                            <semantic-link iri='{{regionIri}}' class="region-label text-truncate"></semantic-link>
                            <div>
                              <mp-event-trigger id='form-event-trigger' type='Component.TemplateUpdate' targets='["region-form"]'
                                              data='{"region": "{{regionIri}}"}'>
                                <button style="margin-right: 5px;">Edit</button>
                              </mp-event-trigger>
                              <mp-event-trigger id='focus-event-trigger' type='IIIFViewer.ZoomToRegion' targets='["image-editor"]'
                                              data='{"imageIri": "{{../imageIri}}","regionIri": "{{regionIri}}"}'>
                                <button style="margin-right: 5px;">Zoom</button>
                              </mp-event-trigger>
                            </div>
                          </div>
                          {{/each}}
                        </div>
                      </div>
                          
                      {{/if}}
                    
                    {{/each}}
                  </div>

                  {{else}}
                  
                    <p>No selected images in the Image Viewer</p>

                  {{/if}}
                </div>
              </template>
          </mp-event-target-template-render>
          
          <mp-event-target-template-render id='region-form' template='{{> template}}'>
            <template id='template'>
              <div>
                {{#if region}}
                  <div class="frame-imageAnnotationWorkspace__form-container">{{log 'region' this}}
                    <h1>Editing image region: &nbsp;<strong><semantic-link iri='{{region}}'></semantic-link></strong></h1>
                    [[> rsp:ImageAnnotationForm]]
                  </div>
                {{else}}
                  <p></p>
                {{/if}}
              </div>
            </template>
          </mp-event-target-template-render>

        </div>

      </div>

  </div>
