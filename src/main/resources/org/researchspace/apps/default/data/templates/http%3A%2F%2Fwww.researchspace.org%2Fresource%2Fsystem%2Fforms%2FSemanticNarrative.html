<semantic-form id='{{#if formId}}{{formId}}{{else}}{{viewId}}-vocab-form{{/if}}' 
                post-action="event"
                subject='{{node}}'
                persistence='{"type": "sparql", "targetInsertGraphIri":"{{node}}/context"}'

                fields='[[fieldDefinitions
                            classtype="http://www.w3.org/1999/02/22-rdf-syntax-ns#type"
                            entity_resource_type="http://www.researchspace.org/pattern/system/entity/resource_type"
                            P2_has_type="http://www.cidoc-crm.org/cidoc-crm/P2_has_type"
                            narrative_title="http://www.researchspace.org/pattern/system/symbolic_object/has_symbolic_contentMin1Max1"
                            narrative_description="http://www.researchspace.org/pattern/system/entity/description"
                  
                            image_main_representation="http://www.researchspace.org/pattern/system/entity/main_image"
                            more_image="http://www.researchspace.org/pattern/system/entity/images"
                            
                          ]]'
              >
              
    <div class="form-scroll-area {{#if nested}}nested-form{{/if}}">
       [[!-- <semantic-form-hidden-input for='classtype' default-value='http://www.ics.forth.gr/isl/CRMdig/D1_Digital_Object'> </semantic-form-hidden-input>
        <semantic-form-hidden-input for='entity_resource_type' default-value='http://www.researchspace.org/resource/system/vocab/resource_type/semantic_narrative'></semantic-form-hidden-input>
        --]]
        <rs-tabs id="{{viewId}}-form-tabs" class-name="form-tabs">
            <rs-tab event-key="detail" title="Details">
                <div>
                    <semantic-form-text-input for="narrative_title" label="Narrative title" 
                                                placeholder="Enter narrative title"> 
                    </semantic-form-text-input>
                            
                    
                    <semantic-form-text-input for="narrative_description" multiline=true label="Description/comment" 
                                                placeholder="Enter narrative description"> 
                    </semantic-form-text-input>
                </div>
            </rs-tab>
           
            [[!--
            {{#if node}}
                <rs-tab event-key="metadata" title="Metadata">
    
                    <semantic-query  query='SELECT ?narrative ?modifiedByUser ?modifiedAtTime WHERE {
                                                BIND(<{{node}}> AS ?narrative)

                                                ?narrative <http://www.w3.org/ns/prov#generatedAtTime> ?modifiedAtTime .

                                                [[#if (hasPermission "forms:ldp:*")]]
                                                    ?narrative <http://www.w3.org/ns/prov#wasAttributedTo> ?modifiedByUser .
                                                [[else]]
                                                    ?narrative <http://www.w3.org/ns/prov#wasAttributedTo> ?modifiedByUser .
                                                    FILTER(?modifiedByUser = <http://www.researchspace.org/resource/system/anonymousUser> )
                                                [[/if]]
                                            }'
                                            template='{{> template}}'
                                    >
                                        
                        <template id='template'>
                            <div class="semantic-form-input-title">Metadata</div>
                            <div class="table-expanded">
                                <table class="table metadata-table">
                                    <tbody>
                                        <tr>
                                            <td class="table-title"><b>modified</b></td>
                                            <td class="table-description">
                                                {{dateTimeFormat bindings.0.modifiedAtTime.value "DD/MM/YYYY, h:mm a"}}
                                            </td>
                                        </tr>
                                        <tr class="standard-row">
                                            <td class="table-title"><b>modified by</b></td>
                                            <td class="table-description">
                                                <rs-icon icon-type="round" icon-name="account_box" class="table-icon"></rs-icon>
                                                {{bindings.0.modifiedByUser.value}}
                                            </td>
                                        </tr>
                                    </tbody>   
                                </table>
                            </div>
                        </template>
                    </semantic-query>
                </rs-tab>
            {{/if}} --]]
        </rs-tabs>
    </div>
  
    <semantic-form-errors></semantic-form-errors>

    [[> rsp:FormDefaultActions formEntity='{{#if entityType}}{{entityType}}{{else}}narrative{{/if}}']]

</semantic-form>